
<!doctype html>
<html ng-app="app">
	<head>
		<meta charset="utf-8" />
		<title>爱编程 | 爱饭否</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="keywords" content="HTML、CSS、JavaScript、Jquery">
		<meta name="author" content="huluoyang@gmail.com">
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/navbar.css">
		<link rel="stylesheet" href="css/console.css" media="screen">
		<link rel="stylesheet" href="css/footer.css">
		<link rel="shortcut icon" href="http://static.fanfou.com/favicon.ico">	
		<style type="text/css">
			.homepage{
			border-top: 9px solid #a8d1e7;
			background-color: #08c;
			padding: 80px 0;
			margin-top: 45px;	
			text-align: center;
			color: white;
			}
			.homepage h4 {
			font-size: 21px;
			margin: 30px 0 20px;
			}
		</style>
	</head>
<body ng-controller="mainCtrl">
	<div class="navbar navbar-inverse">
    <div class="container">
    	<div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
			  </button>
        <a class="nav-brand" href="index.html">
        	<img src="img/1.png">
        	<img src="img/2.png">
        	<img src="img/3.png">
        </a>
      </div>  
      <div class="navbar-collapse collapse">
       	<ul class="nav navbar-nav navbar navbar-right">
   		  	<li><a href="blog.html">博客</a></li>
   		  	<li id="personal" ng-if="isLogin == true"><a data-toggle="modal" data-target="#center">个人中心</a></li>
   		  	<li id="1" ng-if="isLogin == false"><a data-toggle="modal" data-target="#login">登录</a></li> 
          <li id="2" ng-if="isLogin == false"><a data-toggle="modal" data-target="#register">注册</a></li>    		  	  
      	</ul>   
      </div>
    </div>    
	</div>
	<div class="modal fade" id="login">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title">亲，登录后可以保存你的学习记录哦！</h4>
	      </div>
	      <div class="modal-body">
	      	<form class="form-horizontal" name="form2" novalidate ng-submit="login()">
					  <div class="form-group">
					    <label for="email" class="col-sm-2 control-label">邮箱</label>
					    <div class="col-sm-9">
					      <input type="email" class="form-control" id="email" ng-model="user.email" placeholder="请输入您的邮箱" required>
					    </div>
					  </div>
					  <div class="form-group">
					    <label for="password" class="col-sm-2 control-label">密码</label>
					    <div class="col-sm-7">
					      <input type="password" class="form-control password" id="password" ng-model="user.password" placeholder="请输入一个不少于六位的密码" minlength=6 required>
					    </div>
					    <div class="col-sm-2" style="padding-left: 0px;">
					      <button type="button" class="btn btn-info toggle">显示密码</button>
					    </div>					    
					  </div>
					  <div class="form-group">
					    <div class="col-sm-offset-2 col-sm-9">
					      <div class="checkbox">
					        <label>
					          <input type="checkbox" ng-click="rememberMe()" ng-disabled="form.$invalid"> 记住我
					        </label>
					      </div>
					    </div>
					  </div>
					  <div class="form-group">
					    <div class="col-sm-offset-2 col-sm-9">
					      <button type="submit" ng-disabled="form2.$invalid" class="btn btn-success">登录</button>
					    </div>
					  </div>
					</form>  
	      </div>
	    </div>
	  </div>
	</div>
	<div class="modal fade" id="register">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title">亲，注册才可以体验更多爱饭否的功能哦！</h4>
	      </div>
	      <div class="modal-body" >
					<form class="form-horizontal" name="form1" novalidate ng-submit="register()">
					  <div class="form-group">
					    <label for="email" class="col-sm-2 control-label">邮箱</label>
					    <div class="col-sm-9">
					      <input type="email" class="form-control" id="email" ng-model="user.email" placeholder="请输入您的常用邮箱" required>
					    </div>
					  </div>
					  <div class="form-group">
					    <label for="name" class="col-sm-2 control-label">用户名</label>
					    <div class="col-sm-9">
					      <input type="text" class="form-control" id="name" ng-model="user.name" placeholder="请输入您常用的用户名" required>
					    </div>
					  </div>
					  <div class="form-group">
					    <label for="password" class="col-sm-2 control-label">密码</label>
					    <div class="col-sm-7">
					      <input type="password" class="form-control password" id="password" ng-model="user.password" placeholder="请输入一个不少于六位的密码" minlength=6 required>
					    </div>
					    <div class="col-sm-2" style="padding-left: 0px;">
					      <button type="button" class="btn btn-info toggle">显示密码</button>
					    </div>					    
					  </div>
					  <div class="form-group">
					    <div class="col-sm-offset-2 col-sm-9">
					      <button type="submit" ng-disabled="form1.$invalid" class="btn btn-success">注册</button>
					    </div>
					  </div>
					</form>
	      </div>
	    </div>
	  </div>
	</div>
	<div class="modal fade" id="center">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title">亲，在这里可以补充自己的个人信息，更好地向大家展示自己哦！</h4>
	      </div>
	      <div class="modal-body" >
					<form class="form-horizontal" name="form1" novalidate ng-submit="register()">
					  <div class="form-group">
					    <label for="email" class="col-sm-2 control-label">邮箱</label>
					    <div class="col-sm-9">
					      <input type="email" class="form-control" id="email" ng-model="user.email" placeholder="请输入您的常用邮箱" required>
					    </div>
					  </div>
					  <div class="form-group">
					    <label for="name" class="col-sm-2 control-label">用户名</label>
					    <div class="col-sm-9">
					      <input type="text" class="form-control" id="name" ng-model="user.name" placeholder="请输入您常用的用户名" required>
					    </div>
					  </div>
					  <div class="form-group">
					    <label for="password" class="col-sm-2 control-label">密码</label>
					    <div class="col-sm-7">
					      <input type="password" class="form-control" id="password" ng-model="user.password" placeholder="请输入一个不少于六位的密码" minlength=6 required>
					    </div>
					    <div class="col-sm-2" style="padding-left: 0px;">
					      <button type="button" id="toggle" class="btn btn-info">显示密码</button>
					    </div>					    
					  </div>
					  <div class="form-group">
					    <div class="col-sm-offset-2 col-sm-9">
					      <button type="submit" ng-disabled="form1.$invalid" class="btn btn-success">注册</button>
					    </div>
					  </div>
					</form>
	      </div>
	    </div>
	  </div>
	</div>	
	<div class="introduction">
		<div class="container">
			<div class="row">
				<div class="intro col-sm-4">
				    <p>轻松</p>
				    <p>有趣</p>
				    <p>实时互动</p>
				    <p>这就是爱饭否</p>
				    <p>用前所未有的方式学习编程，颠覆你的想象。</p>
				    <p>我和我的小伙伴们都惊呆了，赶快来试试吧！</p>
				</div>
				<div id="console" class="col-sm-8"></div>
			</div>	
		</div>
	</div>	
	<div class="homepage">
		<div class="container">
		    <div class="row">
		        <div class="col-md-4">
		          <div class="img-wrap"><img alt="Projects" src="img/projects.png"></div>
		          <h4>建立项目</h4>
		          <p>学习创建交互网站、有趣的游戏和杀手级应用</p>
		        </div>
		        <div class="col-md-4">
		          <div class="img-wrap"><img alt="Community" src="img/community.png"></div>
		          <h4>加入社区</h4>
		          <p>加入小组和你的小伙伴们一起编程会更有动力</p>
		        </div>
		        <div class="col-md-4">
		          <div class="img-wrap"><img alt="Profile" src="img/profile.png"></div>
		          <h4>展示自己</h4>
		          <p>建立你的资料来展示你积累的学分和徽章吧</p>
		        </div>
		    </div>
		</div>
	</div>	
	<div class="footer">
		<div class="container">
			<div class="row">
				<div class="col-md-4">
					<ul>
				      <li><a href="about.html">关于我</a></li>
				      <li>北京制造</li>
				      <li>© 2014 爱饭否</li>
				    </ul>	
				</div>
			</div>
		</div>
	</div>
<script src="js/jquery-1.8.3.js"></script>	
<script src="js/bootstrap.min.js"></script>
<script src="js/jqconsole.min.js"></script>
<script src="js/angular.js"></script>
<script src="js/angular-cookies.js"></script>
<script src="js/angular-animate.min.js"></script>
<script>
  $(function() {
    // Creating the console.
    var header = '^_^ 欢迎来到爱饭否，让我们来认识下吧。你叫什么名字?\n' +'\n'+
                 '输入你的名字并用引号括住，就像这样"爱饭否"，然后按下键盘上的回车键，也就是Enter键。\n'+'请注意，编写程序时输入的符号都是英文符号！\n';
    window.jqconsole = $('#console').jqconsole(header,'> ');	

    // Abort prompt on Ctrl+Z.
    jqconsole.RegisterShortcut('Z', function() {
      jqconsole.AbortPrompt();
      handler();
    });
    // Move to line start Ctrl+A.
    jqconsole.RegisterShortcut('A', function() {
      jqconsole.MoveToStart();
      handler();
    });
    // Move to line end Ctrl+E.
    jqconsole.RegisterShortcut('E', function() {
      jqconsole.MoveToEnd();
      handler();
    });
    jqconsole.RegisterMatching('{', '}', 'brace');
    jqconsole.RegisterMatching('(', ')', 'paran');
    jqconsole.RegisterMatching('[', ']', 'bracket');
    // Handle a command.
    var handler = function(command) {
      if (command) {
        try {
          jqconsole.Write('==> ' + window.eval(command) + '\n');
          jqconsole.Append('<div class="congratulation"><p class="congratulate-msg">祝贺你，你完成了自己的第一课！<a href="javascript.html" class="btn btn-info">深入学习</a></p></div>')	;
        } catch (e) {
          jqconsole.Write('ERROR: ' + e.message + '\n');
          jqconsole.Write('哦偶，再试试。'+'检查一下，名字需要英文引号括住！'+ '\n');
        }
      }
      jqconsole.Prompt(true, handler, function(command) {
        // Continue line if can't compile the command.
        try {
          Function(command);
        } catch (e) {
          if (/[\[\{\(]$/.test(command)) {
            return 1;
          } else {
            return 0;
          }
        }
        return false;
      });
    };

    // Initiate the first prompt.
    handler();
  });
</script>
<script>
angular.module('app',['ngCookies','ngAnimate'])
.controller('mainCtrl',function($scope,$http,$cookieStore,$animate){
	$scope.user={};
	$scope.user.email = $cookieStore.get('email');
	$scope.user.password = $cookieStore.get('password');
	$scope.isLogin = $cookieStore.get('isLogin') || false;

	// if(isLogin){
	// 	$('#personal').css('display','block');
	// 	$('#1,#2').css('display','none');
	// }
	$scope.login=function(){
		$http.post('/email',{email:$scope.user.email}).success(function(res){
			if(res.status==300){
				$http.post('/login',{email:$scope.user.email,password:$scope.user.password}).success(function(res){
					if(res.status==200){
						alert('恭喜您，登录成功！^_^');
						$cookieStore.put('isLogin',true);
						$scope.isLogin = true;
						$('.close').click();
						// $('#personal').css('display','block');
						// $('#1,#2').css('display','none');
					}else{
						alert('登录失败，你的密码不正确！^_^');
						document.getElementById('password').focus();
					}
				})
			}else{
				alert('该邮箱尚未注册，请直接注册或更换邮箱。^_^');
				document.getElementById('email').focus();
			}
		})		
	}
	$scope.register=function(){
		$http.post('/email',{email:$scope.user.email}).success(function(res){
			if(res.status==404){
				$http.post('/name',{name:$scope.user.name}).success(function(res){
					if(res.status==404){
						$http.post('/register',{email:$scope.user.email,name:$scope.user.name,password:$scope.user.password}).success(function(res){
							if(res.status==200){
								alert('恭喜您，注册成功！^_^')
								$cookieStore.put('isLogin',true);
								$('.close').click();
								$('#personal').css('display','block');
								$('#1,#2').css('display','none');
							}else{
								alert('服务器罢工了，我们正在考虑给它提高待遇。^_^');
							}
						})
					}else{
						alert('该用户名被抢注了，噢噢。^_^');
						document.getElementById('name').focus();
					}
				})
			}else{
				alert('邮箱已存在，请直接登录或更换邮箱。^_^');
				document.getElementById('email').focus();
			}
		})
	}	
	$scope.rememberMe=function(){
		$cookieStore.put('email',$scope.user.email);
		$cookieStore.put('password',$scope.user.password);
	}
});
$('.toggle').toggle(
	function(){
		$('.password').prop('type','text');
		$(this).html('隐藏密码');
	},
	function(){
		$('.password').prop('type','password');
		$(this).html('显示密码');
	}
)
</script>
</body>
</html>